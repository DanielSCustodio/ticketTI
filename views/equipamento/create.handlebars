<section class='form-conatiner'>
  {{#if messages.error-input-equipment}}
    <div class='message-error'>
      <span>{{messages.error-input-equipment}}</span>
    </div>
  {{/if}}
  <form action='/equipamento/add' method='POST' class='form'>
    <div class='form-control'>
      <label for="equipment">Equipamento:</label>
      <input
        id="equipment"
        type='text'
        name='name'
        placeholder='Nome do equipamento'
      />
    </div>
    <div class='form-control'>
      <label>Colaborador:</label>
      <div>
        <input name='personSelected' placeholder="Responsável pelo equipamento" id='personSelected'  readonly/>
        <a href='#' id='openModalBtnPerson'><i class='bi bi-search'></i></a>
      </div>
    </div>
    <div class='form-control'>
      <label>Setor:</label>
      <div>
        <input name='departamentSelected' placeholder="Onde se encontra o equipamento" id='departamentSelected'  readonly/>
        <a href='#' id='openModalBtnDepartament'><i class='bi bi-search'></i></a>
      </div>
    </div>
    <div class='form-control'>
      <label>Tipo de referência:</label>
      <div>
        <input name='referenceTypeSelected' placeholder="Tipo de referência" id='referenceTypeSelected'  readonly/>
        <a href='#' id='openModalBtnReferenceType'><i class='bi bi-search'></i></a>
      </div>
    </div>

    <div class='form-control'>
      <label for="reference">Referência:</label>
      <input
      id="reference"
        type='text'
        name='reference'
        placeholder='Referência do equipamento/sistema'
      />
    </div>
    <div class="btn-submit">
      <input type='submit' value='Cadastrar' class='btn' />
    </div>
  </form>
</section>

<!--Person-->
<section
  class='modal fade'
  id='personModel'
  tabindex='-1'
  role='dialog'
  aria-labelledby='ModalLabelPerson'
  aria-hidden='true'
>
  <div class='modal-dialog' role='document'>
    <div class='modal-content'>
      <div class='modal-header'>
        <h5 class='modal-title' id='ModalLabelPerson'>Colaboradores</h5>
        <button
          type='button'
          class='close'
          data-dismiss='modal'
          aria-label='Close'
        >
          <span aria-hidden='true'>&times;</span>
        </button>
      </div>
      <div class='modal-body'>
        <section>
          <input type="text" id="searchInputPerson" placeholder="Buscar por nome do colaborador">
          <table class='table'>
            <thead>
              <tr>
                <th>ID</th>
                <th>Nome</th>
              </tr>
            </thead>
            <tbody>
              {{#each people}}
                <tr style="cursor: pointer"
                  data-name='{{this.name}}'
                  class='selectable-row-people'
                >
                  <td>{{this.id}}</td>
                  <td>{{this.name}}</td>
                </tr>
              {{/each}}
            </tbody>
          </table>
        </section>
      </div>
      <div class='modal-footer'>
        <span id='currentPage'></span>
        <div class="btn-pagination">
          <button type='button' class='btn btn-table' id='prevPageBtn'>Anterior</button>
          <button type='button' class='btn btn-table' id='nextPageBtn'>Próximo</button>
        </div>
      </div>

    </div>
  </div>
</section>

<!--Refrence Type-->
<section
  class='modal fade'
  id='refrenceTypeModel'
  tabindex='-1'
  role='dialog'
  aria-labelledby='ModalLabelReferenceType'
  aria-hidden='true'
>
  <div class='modal-dialog' role='document'>
    <div class='modal-content'>
      <div class='modal-header'>
        <h5 class='modal-title' id='ModalLabelReferenceType'>Tipos de referência</h5>
        <button
          type='button'
          class='close'
          data-dismiss='modal'
          aria-label='Close'
        >
          <span aria-hidden='true'>&times;</span>
        </button>
      </div>
      <div class='modal-body'>
        <section>
          <!-- Código Handlebars do Modal -->
          <input type="text" id="searchInputReferenceType" placeholder="Buscar por nome do tipo de referência">
          <table class='table'>
            <thead>
              <tr>
                <th>ID</th>
                <th>Nome</th>
              </tr>
            </thead>
            <tbody>
              {{#each referenceType}}
                <tr style="cursor: pointer"
                  data-name='{{this.name}}'
                  class='selectable-row-reference-type'
                >
                  <td>{{this.id}}</td>
                  <td>{{this.name}}</td>
                </tr>
              {{/each}}
            </tbody>
          </table>

        </section>
      </div>
      <div class='modal-footer'>
      </div>
    </div>
  </div>
</section>

<!--Departament-->
<section
  class='modal fade'
  id='departamentModel'
  tabindex='-1'
  role='dialog'
  aria-labelledby='ModalLabelDepartament'
  aria-hidden='true'
>
  <div class='modal-dialog' role='document'>
    <div class='modal-content'>
      <div class='modal-header'>
        <h5 class='modal-title' id='ModalLabelDepartament'>Setores</h5>
        <button
          type='button'
          class='close'
          data-dismiss='modal'
          aria-label='Close'
        >
          <span aria-hidden='true'>&times;</span>
        </button>
      </div>
      <div class='modal-body'>
        <section>
          <!-- Código Handlebars do Modal -->
          <input type="text" id="searchInputDepartament" placeholder="Buscar por nome do setor">
          <table class='table'>
            <thead>
              <tr>
                <th>ID</th>
                <th>Nome</th>
              </tr>
            </thead>
            <tbody>
              {{#each departaments}}
                <tr style="cursor: pointer"
                  data-name='{{this.name}}'
                  class='selectable-row-departaments'
                >
                  <td>{{this.id}}</td>
                  <td>{{this.name}}</td>
                </tr>
              {{/each}}
            </tbody>
          </table>

        </section>
      </div>
      <div class='modal-footer'>
      </div>
    </div>
  </div>
</section>

<script   src='https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha2/dist/js/bootstrap.bundle.min.js' ></script>

<!--Person-->
<script>
document.addEventListener('DOMContentLoaded', function () {
  
  let openModalBtnPerson = document.getElementById('openModalBtnPerson');
  let personModel = new bootstrap.Modal(document.getElementById('personModel'));
  let personSelectedInput = document.getElementById('personSelected');

  openModalBtnPerson.addEventListener('click', function () {
    personModel.show();
  });

  let selectableRowsPerson = document.querySelectorAll('.selectable-row-people');
  selectableRowsPerson.forEach(function (row) {
    row.addEventListener('click', function () {
      let personId = row.getAttribute('data-id');
      let personName = row.getAttribute('data-name');
      personSelectedInput.value = personName;
      personModel.hide();
    });
  });

  searchInputPerson.addEventListener('input', function () {
    let searchTerm = searchInputPerson.value.toLowerCase();

    selectableRowsPerson.forEach(function (row) {
      let rowNamePerson = row.getAttribute('data-name').toLowerCase();
      let isVisible = rowNamePerson.includes(searchTerm);

      // Define a visibilidade da linha com base no termo de busca
      row.style.display = isVisible ? 'table-row' : 'none';
    });
  });
  let currentPage = 1;
  const itemsPerPage = 10;
  const totalItems = selectableRowsPerson.length;

  function paginate(page) {
    const startIndex = (page - 1) * itemsPerPage;
    const endIndex = startIndex + itemsPerPage;

    selectableRowsPerson.forEach(function (row, index) {
      const isVisible = index >= startIndex && index < endIndex;
      row.style.display = isVisible ? 'table-row' : 'none';
    });

    document.getElementById('currentPage').innerText = `Página ${page}`;
  }

  paginate(currentPage);

  document.getElementById('prevPageBtn').addEventListener('click', function () {
    if (currentPage > 1) {
      currentPage--;
      paginate(currentPage);
    }
  });

  document.getElementById('nextPageBtn').addEventListener('click', function () {
    const totalPages = Math.ceil(totalItems / itemsPerPage);
    if (currentPage < totalPages) {
      currentPage++;
      paginate(currentPage);
    }
  });

});
</script>

<!--Reference Type-->
<script>
document.addEventListener('DOMContentLoaded', function () {
  let openModalBtnReferenceType = document.getElementById('openModalBtnReferenceType');
  let refrenceTypeModel = new bootstrap.Modal(document.getElementById('refrenceTypeModel'));
  let referenceTypeSelectedInput = document.getElementById('referenceTypeSelected');

  openModalBtnReferenceType.addEventListener('click', function () {
    refrenceTypeModel.show();
  });

  let selectableRowsreferenceType = document.querySelectorAll('.selectable-row-reference-type');
  selectableRowsreferenceType.forEach(function (row) {
    row.addEventListener('click', function () {
      let referenceTypeId = row.getAttribute('data-id');
      let referenceTypeName = row.getAttribute('data-name');
      referenceTypeSelectedInput.value = referenceTypeName;
      refrenceTypeModel.hide();
    });
  });

  searchInputReferenceType.addEventListener('input', function () {
    let searchTerm = searchInputReferenceType.value.toLowerCase();

    selectableRowsreferenceType.forEach(function (row) {
      let rowNameReferenceType = row.getAttribute('data-name').toLowerCase();
      let isVisible = rowNameReferenceType.includes(searchTerm);

      // Define a visibilidade da linha com base no termo de busca
      row.style.display = isVisible ? 'table-row' : 'none';
    });
  });
});
</script>

<!--Departament-->
<script>
document.addEventListener('DOMContentLoaded', function () {
  let openModalBtnDepartament = document.getElementById('openModalBtnDepartament');
  let departamentModel = new bootstrap.Modal(document.getElementById('departamentModel'));
  let departamentSelectedInput = document.getElementById('departamentSelected');

  openModalBtnDepartament.addEventListener('click', function () {
    departamentModel.show();
  });

  let selectableRowsDepartament = document.querySelectorAll('.selectable-row-departaments');
  selectableRowsDepartament.forEach(function (row) {
    row.addEventListener('click', function () {
      let departamentId = row.getAttribute('data-id');
      let departamentName = row.getAttribute('data-name');
      departamentSelectedInput.value = departamentName;
      departamentModel.hide();
    });
  });

  searchInputDepartament.addEventListener('input', function () {
    let searchTerm = searchInputDepartament.value.toLowerCase();

    selectableRowsDepartament.forEach(function (row) {
      let rowNameDepartament = row.getAttribute('data-name').toLowerCase();
      let isVisible = rowNameDepartament.includes(searchTerm);

      // Define a visibilidade da linha com base no termo de busca
      row.style.display = isVisible ? 'table-row' : 'none';
    });
  });
});
</script>