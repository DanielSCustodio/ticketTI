<section class='form-conatiner'>
  {{#if messages.error-input-administrator}}
    <div class='message'>
      <span>{{messages.error-input-administrator}}</span>
    </div>
  {{/if}}
  <form action='/administrador/add' method='POST' class='form'>
    <div class='form-control'>
      <label>Colaborador:</label>
      <input name='personSelected' id='personSelected' placeholder="Escolha um colaborador" readonly/>
      <a href='#' id='openModalBtnPerson'><i class='bi bi-search'></i></a>
    </div>
    <div class='form-control'>
      <label for="">Nome de usuário:</label>
      <input
        id="usernameSelected"
        readonly
        type='text'
        name='username'
        placeholder='Nome de usuário'
      />
    </div>
    <div class='form-control'>
      <label for="">Senha:</label>
      <input type='password' name='password' placeholder='Escolha uma senha' />
    </div>
    <div class='form-control'>
      <label for="">Confirme a senha:</label>
      <input
        type='password'
        name='confirmpassword'
        placeholder='Confirme a senha'
      />
    </div>
    <div class='form-control'>
      <label>Privilégios de admistrador?</label>
      <select name='privilege'>
        <option value='1'>Sim</option>
        <option value='0'>Não</option>
      </select>
    </div>
    {{#if messages.error-registro}}
      <div class='message'>
        {{messages.error-registro}}
      </div>
    {{/if}}
    <input type='submit' value='Cadastar' class='btn' />
  </form>
</section>

<section
  class='modal fade'
  id='personModel'
  tabindex='-1'
  role='dialog'
  aria-labelledby='ModalLabelPerson'
  aria-hidden='true'
>
  <div class='modal-dialog' role='document'>
    <div class='modal-content'>
      <div class='modal-header'>
        <h5 class='modal-title' id='ModalLabelPerson'>Colaboradores</h5>
        <button
          type='button'
          class='close'
          data-dismiss='modal'
          aria-label='Close'
        >
          <span aria-hidden='true'>&times;</span>
        </button>
      </div>
      <div class='modal-body'>
        <section>
          <input type="text" id="searchInputPerson" placeholder="Buscar por nome do colaborador">
          <table class='table'>
            <thead>
              <tr>
                <th>ID</th>
                <th>Nome</th>
              </tr>
            </thead>
            <tbody>
              {{#each people}}
                <tr style="cursor: pointer"
                  data-name='{{this.name}}'
                  class='selectable-row-people'
                >
                  <td>{{this.id}}</td>
                  <td>{{this.name}}</td>
                </tr>
              {{/each}}
            </tbody>
          </table>
        </section>
      </div>
      <div class='modal-footer'>
        <span id='currentPage'></span>
        <button type='button' class='btn btn-secondary' id='prevPageBtn'>Anterior</button>
        <button type='button' class='btn btn-secondary' id='nextPageBtn'>Próximo</button>
      </div>

    </div>
  </div>
</section>
<script   src='https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha2/dist/js/bootstrap.bundle.min.js' ></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  
  let openModalBtnPerson = document.getElementById('openModalBtnPerson');
  let personModel = new bootstrap.Modal(document.getElementById('personModel'));
  let personSelectedInput = document.getElementById('personSelected');
  let usernameSelectedInput = document.getElementById('usernameSelected');
  

  openModalBtnPerson.addEventListener('click', function () {
    personModel.show();
  });

  let selectableRowsPerson = document.querySelectorAll('.selectable-row-people');
  selectableRowsPerson.forEach(function (row) {
    row.addEventListener('click', function () {
      let personId = row.getAttribute('data-id');
      let personName = row.getAttribute('data-name');
      personSelectedInput.value = personName;
      usernameSelectedInput.value = personName;
      personModel.hide();
    });
  });

  searchInputPerson.addEventListener('input', function () {
    let searchTerm = searchInputPerson.value.toLowerCase();

    selectableRowsPerson.forEach(function (row) {
      let rowNamePerson = row.getAttribute('data-name').toLowerCase();
      let isVisible = rowNamePerson.includes(searchTerm);

      // Define a visibilidade da linha com base no termo de busca
      row.style.display = isVisible ? 'table-row' : 'none';
    });
  });
  let currentPage = 1;
  const itemsPerPage = 10;
  const totalItems = selectableRowsPerson.length;

  function paginate(page) {
    const startIndex = (page - 1) * itemsPerPage;
    const endIndex = startIndex + itemsPerPage;

    selectableRowsPerson.forEach(function (row, index) {
      const isVisible = index >= startIndex && index < endIndex;
      row.style.display = isVisible ? 'table-row' : 'none';
    });

    document.getElementById('currentPage').innerText = `Página ${page}`;
  }

  paginate(currentPage);

  document.getElementById('prevPageBtn').addEventListener('click', function () {
    if (currentPage > 1) {
      currentPage--;
      paginate(currentPage);
    }
  });

  document.getElementById('nextPageBtn').addEventListener('click', function () {
    const totalPages = Math.ceil(totalItems / itemsPerPage);
    if (currentPage < totalPages) {
      currentPage++;
      paginate(currentPage);
    }
  });

});
</script>
